# build manifest for SourceHut
# https://man.sr.ht/builds.sr.ht/
image: ubuntu/lts
packages:
  - autoconf
  - build-essential
  - libtool
  - automake
  - libpam-dev
  - libssl-dev
  - clang
  - clang-tools
sources:
  - https://git.sr.ht/~kravietz/pam-tacplus
tasks:
  - gnulib: |
      git clone https://git.savannah.gnu.org/git/gnulib.git
      cd pam-tacplus
      /opt/gnulib/gnulib/gnulib-tool --makefile-name=Makefile.gnulib --libtool --import  fcntl crypto/md5 array-list list xlist getrandom realloc-posix explicit_bzero xalloc
      autoreconf -f -v -i
  - build-cc: |
      cd pam-tacplus
      ./configure
      make clean all